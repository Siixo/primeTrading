# Update package list
sudo apt update

# Install Python and pip if not already installed
sudo apt install python3 python3-pip python3-venv

# Install PostgreSQL and related packages
sudo apt install postgresql postgresql-contrib libpq-dev

# Switch to postgres user
sudo -u postgres psql

# In the PostgreSQL prompt, run these commands:
# CREATE DATABASE your_db_name;
# CREATE USER your_db_user WITH PASSWORD 'your_password';
# ALTER ROLE your_db_user SET client_encoding TO 'utf8';
# ALTER ROLE your_db_user SET default_transaction_isolation TO 'read committed';
# ALTER ROLE your_db_user SET timezone TO 'UTC';
# GRANT ALL PRIVILEGES ON DATABASE your_db_name TO your_db_user;
# \q

# Create a project directory
mkdir my_django_project
cd my_django_project

# Create and activate virtual environment
python3 -m venv venv
source venv/bin/activate

# Install Django and psycopg2 (PostgreSQL adapter)
pip install django psycopg2-binary

# Create Django project
django-admin startproject myproject .

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'your_db_name',
        'USER': 'your_db_user',
        'PASSWORD': 'your_password',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}

# Apply migrations
python manage.py migrate

# Create a superuser (optional but recommended)
python manage.py createsuperuser

# Run the development server
python manage.py runserver


##DOCKER##
# From the primeTrading directory
docker-compose up --build

# Or run in detached mode
docker-compose up -d --build

# Stop everything
docker-compose down

# Stop and remove volumes (database data)
docker-compose down -v


